
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Death by JBoss 6 Classloading</title>
    
    <meta name="author" content="Jan Algermissen">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes//bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes//css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Applying the Web To Enterprise IT</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Death by JBoss 6 Classloading </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>08 May 2012</span>
    </div>
    <div class="content">
      <p>During the last week I have spent hour after hour to debug some strange behavior shown by some of my JAX-RS provider classes in two JavaEE6 projects. When I deployed the WARs of the two projects suddenly in one of the projects all providers from both projects where available and in the other none, … zero, zip.</p>

<p>Naturally, I only saw this by accident, after an extensive two-day search in one of the projects for a potential bug caused by myself. Dang! - When I, frustrated as I was, re-deployed the other project I saw the providers I had been looking for in the first deployed app.</p>

<p>Yes, I know now, that I should have thought about the interference between the two right away…but you know how these things go.</p>

<p>When it finally dawned on me that I fell victim to some default configuration in JBoss that (at least to me) is totally counter intuitive the search went reasonably well. (Though documentation at jboss.org is still way to hard to find for my taste)</p>

<p>I figured I had to isolate my class loaders with something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;code&gt;&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;jboss-web&gt;
&lt;class-loading&gt;
      &lt;loader-repository&gt;com.example:archive=myapp-1.war
        &lt;loader-repository-config&gt;java2ParentDelegation=false&lt;/loader-repository-config&gt;
      &lt;/loader-repository&gt;
   &lt;/class-loading&gt;
&lt;/jboss-web&gt;&lt;/code&gt;
</code></pre>
</div>

<p>The crappy thing about this is that apparently the reason for the non-intuitive default is that versions prior to JBoss 5 exhibit not-isolated class loading. The designers of JBoss 5+ desired to make the old configurations work in the newer JBosses without adjustments. Makes me shiver.</p>

<p><strong>Edit</strong>: Turns out you also need to set java2ParentDelegation=false in the example above to make it work.</p>

<p><strong>Edit</strong>: Nope - the above also did not do the trick. After a wasted week of digging around, I give up now, simply installing another JBoss (unable to switch to Glassfish due to external forces :-(.</p>

<p>Useful references:
<a href="https://community.jboss.org/wiki/ClassLoadingConfiguration">https://community.jboss.org/wiki/ClassLoadingConfiguration</a>
<a href="https://community.jboss.org/wiki/JBossClassLoadingUseCases">https://community.jboss.org/wiki/JBossClassLoadingUseCases</a></p>


    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#Java Class Loading-ref">
    		Java Class Loading <span>1</span>
    	</a></li>
     
    	<li><a href="/categories.html#JavaEE6-ref">
    		JavaEE6 <span>3</span>
    	</a></li>
     
    	<li><a href="/categories.html#JBoss6-ref">
    		JBoss6 <span>1</span>
    	</a></li>
    
  


    </ul>
    

    

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2011/11/esi-facelift" title="ESI Facelift">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/2012/09/declarative-cache-control-with-jax-rs-2-0" title="Declarative Cache Control with JAX-RS 2.0">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    
  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2017 Jan Algermissen
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

